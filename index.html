<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>نوژشاپ - فروشگاه لوازم آرایشی و بهداشتی</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
<style>
  body { background: #f9f9fb; font-family: "Tahoma", sans-serif; margin:0; padding:0;}
  header { background-color: #d63384; color: white; padding: 1rem 0; }
  footer { background-color: #d63384; color: white; padding: 1rem 0; margin-top: 2rem; }
  .product-img { height: 200px; object-fit: cover; border-radius: 10px; }
  .trust-logo { height: 60px; margin-left: 15px; }
  nav a.nav-link.active { font-weight: bold; color: #d63384 !important; }
  #adminSection { display: none; padding-bottom: 3rem;}
  .product-img-thumb { width: 60px; height: 40px; object-fit: cover; border-radius: 6px; margin-left: 8px; }
  nav .navbar-toggler-icon {
    filter: invert(33%) sepia(54%) saturate(6817%) hue-rotate(322deg) brightness(89%) contrast(103%);
  }
</style>
</head>
<body>

<header class="text-center">
  <h1>نوژشاپ</h1>
  <p>فروشگاه آنلاین لوازم آرایشی و بهداشتی</p>
</header>

<nav class="navbar navbar-expand-lg navbar-light bg-light mb-3">
  <div class="container">
    <a class="navbar-brand" href="#" id="nav-home">نوژشاپ</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
      aria-controls="navbarNav" aria-expanded="false" aria-label="نمایش فهرست">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link active" href="#" id="link-home">خانه</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="link-products">محصولات</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="link-contact">تماس با ما</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="link-admin">مدیریت سایت</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container">

  <!-- صفحه اصلی -->
  <div id="mainSection">
    <!-- خانه -->
    <section id="home" class="mb-5 text-center">
      <h2>به نوژشاپ خوش آمدید!</h2>
      <p style="max-width: 600px; margin: auto; font-size: 1.1rem; color: #555;">
        تو نوژشاپ، ما باور داریم زیبایی حق همه‌ست.  
        محصولات باکیفیت و تازه‌ترین برندهای آرایشی و بهداشتی رو با قیمت مناسب براتون فراهم کردیم.  
        تیم ما همیشه آماده‌ست تا بهترین‌ها رو به دست شما برسونه و تجربه خریدی راحت و لذت‌بخش داشته باشید.  
        با نوژشاپ، درخشش و سلامت پوست و مو رو به خودتون هدیه بدید!  
      </p>
    </section>

    <!-- محصولات -->
    <section id="products" class="mb-5" style="display:none;">
      <h2 class="mb-4 text-center">محصولات ما</h2>
      <div class="row g-4" id="product-list"></div>
    </section>

    <!-- تماس با ما -->
    <section id="contact" class="mb-5 text-center" style="display:none;">
      <h2>تماس با ما</h2>
      <p>برای سفارش و سوالات، در تلگرام با ما در ارتباط باشید:</p>
      <a href="https://t.me/noj1385" target="_blank" class="btn btn-primary">آیدی تلگرام: @noj1385</a>
    </section>
  </div>

  <!-- صفحه مدیریت -->
  <div id="adminSection" dir="rtl">
    <header class="text-center mb-4">
      <h1>مدیریت نوژشاپ</h1>
    </header>

    <div id="loginSection" class="mb-4 text-center">
      <h4>ورود به مدیریت سایت</h4>
      <div class="input-group mb-3 mx-auto" style="max-width: 300px;">
        <input type="password" id="adminPassword" class="form-control" placeholder="رمز را وارد کنید" />
        <button class="btn btn-primary" id="loginBtn">ورود</button>
      </div>
      <div id="loginMsg" class="text-danger"></div>
    </div>

    <div id="manageSection" style="display:none;">
      <h2>مدیریت محصولات</h2>
      <ul class="list-group mb-3" id="manageProductList"></ul>

      <h5>افزودن محصول جدید</h5>
      <form id="addProductForm" class="mb-5 mx-auto" style="max-width: 500px;">
        <input type="text" class="form-control mb-2" id="newTitle" placeholder="عنوان محصول" required />
        <input type="text" class="form-control mb-2" id="newPrice" placeholder="قیمت (مثلاً ۲۰۰,۰۰۰ تومان)" required />
        <input type="text" class="form-control mb-2" id="newImage" placeholder="آدرس تصویر محصول (لینک مستقیم)" required />
        <button type="submit" class="btn btn-success w-100">افزودن محصول</button>
      </form>

      <h2>مدیریت سفارشات</h2>
      <ul class="list-group" id="manageOrderList"></ul>
    </div>
  </div>

</main>

<footer class="text-center">
  <div class="container d-flex justify-content-center align-items-center flex-wrap">
    <img src="https://trustseal.enamad.ir/logo.aspx?id=124674&amp;Code=e5LfFkIfiWLnlq2FrP01" 
         alt="نماد اعتماد الکترونیکی" class="trust-logo" />
    <span>© ۲۰۲۵ نوژشاپ - تمامی حقوق محفوظ است</span>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // داده های اولیه محصولات
  let products = [
    {id:1, title:"کرم مرطوب‌کننده", price:"۲۵۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=400&q=60"},
    {id:2, title:"رژ لب مایع مات", price:"۱۵۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1600180758890-9b6b6a7ef7c9?auto=format&fit=crop&w=400&q=60"},
    {id:3, title:"سرم ویتامین C", price:"۳۲۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1575936123452-b67c3203c357?auto=format&fit=crop&w=400&q=60"},
    {id:4, title:"ادو پرفیوم زنانه", price:"۴۰۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1542831371-29b0f74f9713?auto=format&fit=crop&w=400&q=60"},
    {id:5, title:"ماسک صورت", price:"۱۸۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1516054712743-7a2fc0e960f3?auto=format&fit=crop&w=400&q=60"},
    {id:6, title:"لاک ناخن رنگی", price:"۹۰,۰۰۰ تومان", image:"https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=400&q=60"},
  ];

  // سفارشات ذخیره شده
  let orders = [];

  // بارگذاری از localStorage
  function loadData() {
    const savedProducts = localStorage.getItem("products");
    if(savedProducts) products = JSON.parse(savedProducts);

    const savedOrders = localStorage.getItem("orders");
    if(savedOrders) orders = JSON.parse(savedOrders);
  }

  // ذخیره داده‌ها در localStorage
  function saveData() {
    localStorage.setItem("products", JSON.stringify(products));
    localStorage.setItem("orders", JSON.stringify(orders));
  }

  // --- صفحه اصلی ---

  // نمایش محصولات در صفحه اصلی
  function showProducts() {
    const productList = document.getElementById("product-list");
    productList.innerHTML = "";
    products.forEach(p => {
      const col = document.createElement("div");
      col.className = "col-12 col-md-4";
      col.innerHTML = `
        <div class="card shadow-sm">
          <img src="${p.image}" class="card-img-top product-img" alt="${p.title}" />
          <div class="card-body text-center">
            <h5 class="card-title">${p.title}</h5>
            <p class="card-text text-danger fw-bold">${p.price}</p>
            <button class="btn btn-danger buyBtn" data-id="${p.id}">خرید</button>
          </div>
        </div>
      `;
      productList.appendChild(col);
    });
    attachBuyEvents();
  }

  // اتصال رویداد به دکمه خرید
  function attachBuyEvents() {
    document.querySelectorAll(".buyBtn").forEach(btn => {
      btn.onclick = e => {
        const id = parseInt(e.target.dataset.id);
        const product = products.find(p => p.id === id);
        if(product) {
          openOrderForm(product);
        }
      };
    });
  }

  // نمایش فرم سفارش
  function openOrderForm(product) {
    let formHtml = `
    <div class="modal fade" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" dir="rtl">
          <div class="modal-header">
            <h5 class="modal-title" id="orderModalLabel">ثبت سفارش - ${product.title}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="بستن"></button>
          </div>
          <div class="modal-body">
            <form id="orderForm">
              <div class="mb-3">
                <label for="customerName" class="form-label">نام و نام خانوادگی</label>
                <input type="text" class="form-control" id="customerName" required />
              </div>
              <div class="mb-3">
                <label for="customerPhone" class="form-label">شماره تماس</label>
                <input type="tel" class="form-control" id="customerPhone" required />
              </div>
              <div class="mb-3">
                <label for="customerAddress" class="form-label">آدرس منزل</label>
                <input type="text" class="form-control" id="customerAddress" required />
              </div>
              <div class="mb-3">
                <label for="customerPostal" class="form-label">کد پستی</label>
                <input type="text" class="form-control" id="customerPostal" required />
              </div>
              <input type="hidden" id="productId" value="${product.id}" />
              <button type="submit" class="btn btn-success w-100">ثبت سفارش</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    `;
    document.body.insertAdjacentHTML("beforeend", formHtml);
    const orderModal = new bootstrap.Modal(document.getElementById('orderModal'));
    orderModal.show();

    document.getElementById("orderForm").onsubmit = function(e) {
      e.preventDefault();
      const order = {
        id: Date.now(),
        productId: product.id,
        productTitle: product.title,
        customerName: document.getElementById("customerName").value.trim(),
        customerPhone: document.getElementById("customerPhone").value.trim(),
        customerAddress: document.getElementById("customerAddress").value.trim(),
        customerPostal: document.getElementById("customerPostal").value.trim(),
        time: new Date().toLocaleString()
      };
      orders.push(order);
      saveData();
      alert("سفارش شما با موفقیت ثبت شد.");
      orderModal.hide();
      document.getElementById('orderModal').remove();
    };

    document.getElementById('orderModal').addEventListener('hidden.bs.modal', function () {
      document.getElementById('orderModal').remove();
    });
  }

  // --- صفحه مدیریت ---

  const loginSection = document.getElementById("loginSection");
  const manageSection = document.getElementById("manageSection");
  const loginBtn = document.getElementById("loginBtn");
  const loginMsg = document.getElementById("loginMsg");
  const adminPasswordInput = document.getElementById("adminPassword");
  const manageProductList = document.getElementById("manageProductList");
  const manageOrderList = document.getElementById("manageOrderList");

  // ورود به بخش مدیریت
  loginBtn.onclick = () => {
    const val = adminPasswordInput.value;
    if(val === "1225") {
      loginSection.style.display = "none";
      manageSection.style.display = "block";
      renderManageProducts();
      renderManageOrders();
      adminPasswordInput.value = "";
      loginMsg.textContent = "";
    } else {
      loginMsg.textContent = "رمز اشتباه است.";
    }
  };

  // نمایش لیست محصولات مدیریت
  function renderManageProducts() {
    manageProductList.innerHTML = "";
    products.forEach(p => {
      const li = document.createElement("li");
      li.className = "list-group-item d-flex align-items-center justify-content-between flex-wrap";
      li.innerHTML = `
        <div class="d-flex align-items-center flex-wrap" style="gap:8px;">
          <img src="${p.image}" class="product-img-thumb" alt="${p.title}" />
          <div>
            <input type="text" class="form-control mb-1 productTitleInput" value="${p.title}" data-id="${p.id}" />
            <input type="text" class="form-control productPriceInput" value="${p.price}" data-id="${p.id}" />
            <input type="text" class="form-control mt-1 productImageInput" value="${p.image}" data-id="${p.id}" />
          </div>
        </div>
        <div class="d-flex gap-2 mt-2 mt-md-0">
          <button class="btn btn-success btn-sm editBtn" data-id="${p.id}">ویرایش</button>
          <button class="btn btn-danger btn-sm deleteBtn" data-id="${p.id}">حذف</button>
        </div>
      `;
      manageProductList.appendChild(li);
    });

    // دکمه‌های ویرایش
    document.querySelectorAll(".editBtn").forEach(btn => {
      btn.onclick = e => {
        const id = parseInt(e.target.dataset.id);
        const title = document.querySelector(`.productTitleInput[data-id='${id}']`).value.trim();
        const price = document.querySelector(`.productPriceInput[data-id='${id}']`).value.trim();
        const image = document.querySelector(`.productImageInput[data-id='${id}']`).value.trim();
        if(title && price && image) {
          const idx = products.findIndex(p => p.id === id);
          if(idx > -1) {
            products[idx].title = title;
            products[idx].price = price;
            products[idx].image = image;
            saveData();
            showProducts();
            alert("محصول ویرایش شد.");
          }
        } else {
          alert("لطفا همه فیلدها را پر کنید.");
        }
      };
    });

    // دکمه‌های حذف محصول
    document.querySelectorAll(".deleteBtn").forEach(btn => {
      btn.onclick = e => {
        const id = parseInt(e.target.dataset.id);
        if(confirm("آیا مطمئنید می‌خواهید این محصول حذف شود؟")) {
          products = products.filter(p => p.id !== id);
          saveData();
          renderManageProducts();
          showProducts();
        }
      };
    });
  }

  // افزودن محصول جدید
  document.getElementById("addProductForm").onsubmit = function(e) {
    e.preventDefault();
    const title = document.getElementById("newTitle").value.trim();
    const price = document.getElementById("newPrice").value.trim();
    const image = document.getElementById("newImage").value.trim();
    if(title && price && image) {
      const newId = products.length ? Math.max(...products.map(p => p.id)) + 1 : 1;
